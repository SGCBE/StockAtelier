<!DOCTYPE html>
<html>
<head>
  <title>Gestion des équipements</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
    }

    .header {
      background-color: #fff;
      padding: 16px;
      display: flex;
      align-items: center;
    }

    .header-logo {
      margin-right: 16px;
    }

    .header-title {
      font-size: 24px;
      color: #333;
      margin: 0;
      flex-grow: 1;
      text-align: center;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px;
    }

    .filter {
      margin-bottom: 16px;
    }

    .equipment-list {
      width: 100%;
      border-collapse: collapse;
    }

    .equipment-list th,
    .equipment-list td {
      padding: 8px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    .equipment-list th {
      font-weight: bold;
    }

    .equipment-list tr:hover {
      background-color: #f9f9f9;
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 16px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
      position: relative;
    }

    .modal-content h2 {
      font-size: 20px;
      margin-top: 0;
    }

    .modal-content p {
      margin-bottom: 8px;
    }

    .modal-buttons {
      text-align: right;
      margin-top: 20px;
    }

    .modal-buttons button {
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div class="header">
    <img class="header-logo" src="logo.jpg" alt="Logo">
    <h1 class="header-title">Gestion des équipements</h1>
  </div>

  <div class="container">
    <div class="filter">
      <label for="category-filter">Catégorie :</label>
      <select id="category-filter">
        <option value="">Toutes</option>
        <option value="Cuisson">Cuisson</option>
        <option value="Froid">Froid</option>
        <option value="Inox">Inox</option>
        <option value="Laverie">Laverie</option>
        <option value="Préparation">Préparation</option>
      </select>
    </div>

    <table id="equipment-list" class="equipment-list">
      <thead>
        <tr>
          <th>Désignation</th>
          <th>Marque</th>
          <th>Quantité</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="add-equipment-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Ajouter un équipement</h2>
      <div>
        <label for="category-input">Catégorie :</label>
        <input type="text" id="category-input" required>
      </div>
      <div>
        <label for="designation-input">Désignation :</label>
        <input type="text" id="designation-input" required>
      </div>
      <div>
        <label for="quantity-input">Quantité :</label>
        <input type="number" id="quantity-input" required>
      </div>
      <div>
        <label for="brand-input">Marque :</label>
        <input type="text" id="brand-input" required>
      </div>
      <div>
        <label for="model-input">Modèle :</label>
        <input type="text" id="model-input">
      </div>
      <div>
        <label for="dimensions-input">Dimensions :</label>
        <input type="text" id="dimensions-input">
      </div>
      <div>
        <label for="price-input">Prix d'achat HT unitaire :</label>
        <input type="number" id="price-input" step="0.01" required>
      </div>
      <button id="save-equipment-btn">Ajouter</button>
    </div>
  </div>

  <div id="equipment-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Détails de l'équipement</h2>
      <div id="equipment-details"></div>
      <div class="modal-buttons">
        <button id="edit-equipment-btn">Modifier</button>
        <button id="delete-equipment-btn">Supprimer</button>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
const firebaseConfig = {
  apiKey: "AIzaSyCRxjJPOHEBAbnXQariFN6funIWPpsIe28",
  authDomain: "atelier---gestion-de-stock.firebaseapp.com",
  databaseURL: "https://atelier---gestion-de-stock-default-rtdb.firebaseio.com",
  projectId: "atelier---gestion-de-stock",
  storageBucket: "atelier---gestion-de-stock.appspot.com",
  messagingSenderId: "92935528444",
  appId: "1:92935528444:web:57786855ed9cc7ef129c79"
};

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const equipmentsRef = db.collection("equipments");

    const equipmentList = document.querySelector("#equipment-list tbody");
    const categoryFilter = document.getElementById("category-filter");
    const addEquipmentModal = document.getElementById("add-equipment-modal");
    const saveEquipmentBtn = document.getElementById("save-equipment-btn");
    const equipmentModal = document.getElementById("equipment-modal");
    const editEquipmentBtn = document.getElementById("edit-equipment-btn");
    const deleteEquipmentBtn = document.getElementById("delete-equipment-btn");

    const renderEquipmentList = (querySnapshot) => {
      equipmentList.innerHTML = "";

      querySnapshot.forEach((doc) => {
        const equipment = doc.data();
        equipment.id = doc.id;

        const row = document.createElement("tr");

        const designationCell = document.createElement("td");
        designationCell.textContent = equipment.designation;

        const brandCell = document.createElement("td");
        brandCell.textContent = equipment.marque;

        const quantityCell = document.createElement("td");
        quantityCell.textContent = equipment.quantite;

        row.appendChild(designationCell);
        row.appendChild(brandCell);
        row.appendChild(quantityCell);

        row.addEventListener("click", () => {
          displayEquipmentModal(equipment);
        });

        equipmentList.appendChild(row);
      });
    };

    const displayEquipmentModal = (equipment) => {
      const detailsContainer = document.getElementById("equipment-details");
      detailsContainer.innerHTML = "";

      const category = document.createElement("p");
      category.textContent = `Catégorie: ${equipment.categorie}`;
      detailsContainer.appendChild(category);

      const designation = document.createElement("p");
      designation.textContent = `Désignation: ${equipment.designation}`;
      detailsContainer.appendChild(designation);

      const quantity = document.createElement("p");
      quantity.textContent = `Quantité: ${equipment.quantite}`;
      detailsContainer.appendChild(quantity);

      const brand = document.createElement("p");
      brand.textContent = `Marque: ${equipment.marque}`;
      detailsContainer.appendChild(brand);

      const model = document.createElement("p");
      model.textContent = `Modèle: ${equipment.modele}`;
      detailsContainer.appendChild(model);

      const dimensions = document.createElement("p");
      dimensions.textContent = `Dimensions: ${equipment.dimensions}`;
      detailsContainer.appendChild(dimensions);

      const price = document.createElement("p");
      price.textContent = `Prix d'achat HT unitaire: ${equipment.prix_achat_ht}`;
      detailsContainer.appendChild(price);

      equipmentModal.style.display = "block";

      editEquipmentBtn.addEventListener("click", () => {
        editEquipment(equipment);
      });

      deleteEquipmentBtn.addEventListener("click", () => {
        deleteEquipment(equipment);
      });
    };

    const editEquipment = (equipment) => {
      // TODO: Implement logic for editing equipment
    };

    const deleteEquipment = (equipment) => {
      const confirmDelete = confirm("Êtes-vous sûr de vouloir supprimer cet équipement ?");
      if (confirmDelete) {
        equipmentsRef.doc(equipment.id).delete();
      }
    };

    categoryFilter.addEventListener("change", () => {
      const category = categoryFilter.value;

      if (category === "") {
        equipmentsRef.onSnapshot((querySnapshot) => {
          renderEquipmentList(querySnapshot);
        });
      } else {
        equipmentsRef
          .where("categorie", "==", category)
          .onSnapshot((querySnapshot) => {
            renderEquipmentList(querySnapshot);
          });
      }
    });

    saveEquipmentBtn.addEventListener("click", () => {
      const categoryInput = document.getElementById("category-input");
      const designationInput = document.getElementById("designation-input");
      const quantityInput = document.getElementById("quantity-input");
      const brandInput = document.getElementById("brand-input");
      const modelInput = document.getElementById("model-input");
      const dimensionsInput = document.getElementById("dimensions-input");
      const priceInput = document.getElementById("price-input");

      const newEquipment = {
        categorie: categoryInput.value,
        designation: designationInput.value,
        quantite: parseInt(quantityInput.value),
        marque: brandInput.value,
        modele: modelInput.value,
        dimensions: dimensionsInput.value,
        prix_achat_ht: parseFloat(priceInput.value)
      };

      equipmentsRef.add(newEquipment);

      addEquipmentModal.style.display = "none";
      categoryInput.value = "";
      designationInput.value = "";
      quantityInput.value = "";
      brandInput.value = "";
      modelInput.value = "";
      dimensionsInput.value = "";
      priceInput.value = "";
    });

    const closeButtons = document.querySelectorAll(".close");

    closeButtons.forEach((button) => {
      button.addEventListener("click", () => {
        addEquipmentModal.style.display = "none";
        equipmentModal.style.display = "none";
      });
    });

    const openAddEquipmentModal = () => {
      addEquipmentModal.style.display = "block";
    };

    window.addEventListener("click", (event) => {
      if (event.target === addEquipmentModal || event.target === equipmentModal) {
        addEquipmentModal.style.display = "none";
        equipmentModal.style.display = "none";
      }
    });

    document.getElementById("add-equipment-btn").addEventListener("click", openAddEquipmentModal);

    equipmentsRef.onSnapshot((querySnapshot) => {
      renderEquipmentList(querySnapshot);
    });
  </script>
</body>
</html>
